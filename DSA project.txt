/* P3.1 Program of single linked list of non-integer type node */

#include<stdio.h>
#include<stdlib.h>
#include<string.h>

typedef struct student
{
    int roll_no;
    char name[100];
    float marks;
    struct student *next;
}node;

node *create_list();
void display(node *);
void count(node *);
void search(node *,int);
node *addatbeg(node *);
node *addatend(node *);
node *addafter(node *,int);
node *addbefore(node *,int);
node *addatpos(node *,int);
node *del(node *,int);
node *reverse(node *);
node *getnode();   // ADDED PROTOTYPE

int main()
{
    int choice,data,item,pos;
    node *start = NULL;

    do
    {
        printf("\nENTER YOUR CHOICE\n");
        printf("1. Create List\n");
        printf("2. Display\n");
        printf("3. Count\n");
        printf("4. Search\n");
        printf("5. Add at beginning\n");
        printf("6. Add at end\n");
        printf("7. Add after node\n");
        printf("8. Add before node\n");
        printf("9. Add at position\n");
        printf("10. Delete\n");
        printf("11. Reverse\n");
        printf("12. Quit\n\n");

        printf("Enter your choice : ");
        scanf("%d",&choice);

        switch(choice)
        {
            case 1:
                start = create_list();
                break;

            case 2:
                display(start);
                break;

            case 3:
                count(start);
                break;

            case 4:
                printf("Enter the roll no to search : ");
                scanf("%d",&data);
                search(start,data);
                break;

            case 5:
                start = addatbeg(start);
                break;

            case 6:
                start = addatend(start);
                break;

            case 7:
                printf("Enter the roll no after which to insert : ");
                scanf("%d",&item);
                start = addafter(start,item);
                break;

            case 8:
                printf("Enter the roll no before which to insert : ");
                scanf("%d",&item);
                start = addbefore(start,item);
                break;

            case 9:
                printf("Enter the position at which to insert : ");
                scanf("%d",&pos);
                start = addatpos(start,pos);
                break;

            case 10:
                printf("Enter the roll no to be deleted : ");
                scanf("%d",&data);
                start = del(start,data);
                break;

            case 11:
                start = reverse(start);
                break;

            case 12:
                exit(0);

            default:
                printf("Wrong choice\n");
        }
    }while(choice != 12);

    return 0;
}

/* Create list */
node *create_list()
{
    int roll;
    float marks;
    char Name[100];
    char ans = 'y';

    node *temp = NULL, *newNode, *start = NULL;

    do
    {
        printf("Enter roll number : ");
        scanf("%d",&roll);

        printf("Enter name : ");
        scanf(" %[^\n]", Name);

        printf("Enter marks : ");
        scanf("%f",&marks);

        newNode = getnode();
        newNode->roll_no = roll;
        strcpy(newNode->name, Name);
        newNode->marks = marks;

        if(start == NULL)
        {
            start = newNode;
            temp = newNode;
        }
        else
        {
            temp->next = newNode;
            temp = newNode;
        }

        printf("Do you want to enter more elements (y/n)? ");
        scanf(" %c", &ans);

    } while(ans == 'y' || ans == 'Y');

    printf("\nThe single linked list is created.\n");
    return start;
}

/* Get new node */
node *getnode()
{
    node *temp = (node*)malloc(sizeof(node));
    temp->next = NULL;
    return temp;
}

/* Display list */
void display(node *start)
{
    node *p = start;

    if(p == NULL)
    {
        printf("List is empty\n");
        return;
    }

    printf("\nList is :\n");
    while(p != NULL)
    {
        printf("%d | %s | %.2f\n", p->roll_no, p->name, p->marks);
        p = p->next;
    }
    printf("\n");
}

/* Count nodes */
void count(node *start)
{
    int cnt = 0;
    node *p = start;

    while(p != NULL)
    {
        cnt++;
        p = p->next;
    }

    printf("Number of elements = %d\n", cnt);
}

/* Search */
void search(node *start, int data)
{
    node *p = start;
    int pos = 1;

    while(p != NULL)
    {
        if(p->roll_no == data)
        {
            printf("Item %d found at position %d\n", data, pos);
            return;
        }
        pos++;
        p = p->next;
    }

    printf("Item %d not found in list\n", data);
}

/* Add at beginning */
node *addatbeg(node *start)
{
    node *newNode = getnode();

    printf("Enter roll no : ");
    scanf("%d",&newNode->roll_no);

    printf("Enter name : ");
    scanf(" %[^\n]", newNode->name);

    printf("Enter marks : ");
    scanf("%f",&newNode->marks);

    newNode->next = start;
    return newNode;
}

/* Add at end */
node *addatend(node *start)
{
    node *p = start, *newNode = getnode();

    printf("Enter roll no : ");
    scanf("%d",&newNode->roll_no);

    printf("Enter name : ");
    scanf(" %[^\n]", newNode->name);

    printf("Enter marks : ");
    scanf("%f",&newNode->marks);

    if(start == NULL)
        return newNode;

    while(p->next != NULL)
        p = p->next;

    p->next = newNode;
    return start;
}

/* Add after */
node *addafter(node *start, int item)
{
    node *p = start, *newNode;

    while(p != NULL)
    {
        if(p->roll_no == item)
        {
            newNode = getnode();

            printf("Enter roll no : ");
            scanf("%d",&newNode->roll_no);

            printf("Enter name : ");
            scanf(" %[^\n]", newNode->name);

            printf("Enter marks : ");
            scanf("%f",&newNode->marks);

            newNode->next = p->next;
            p->next = newNode;

            return start;
        }
        p = p->next;
    }

    printf("%d not present in the list\n", item);
    return start;
}

/* Add before */
node *addbefore(node *start, int item)
{
    node *p, *newNode;

    if(start == NULL)
    {
        printf("List is empty\n");
        return start;
    }

    /* insert before first */
    if(start->roll_no == item)
    {
        newNode = getnode();

        printf("Enter roll no : ");
        scanf("%d",&newNode->roll_no);

        printf("Enter name : ");
        scanf(" %[^\n]", newNode->name);

        printf("Enter marks : ");
        scanf("%f",&newNode->marks);

        newNode->next = start;
        return newNode;
    }

    p = start;
    while(p->next != NULL)
    {
        if(p->next->roll_no == item)
        {
            newNode = getnode();

            printf("Enter roll no : ");
            scanf("%d",&newNode->roll_no);

            printf("Enter name : ");
            scanf(" %[^\n]", newNode->name);

            printf("Enter marks : ");
            scanf("%f",&newNode->marks);

            newNode->next = p->next;
            p->next = newNode;
            return start;
        }
        p = p->next;
    }

    printf("%d not present in list\n", item);
    return start;
}

/* Add at position */
node *addatpos(node *start, int pos)
{
    int i;
    node *p = start, *newNode = getnode();

    printf("Enter roll no : ");
    scanf("%d",&newNode->roll_no);

    printf("Enter name : ");
    scanf(" %[^\n]", newNode->name);

    printf("Enter marks : ");
    scanf("%f",&newNode->marks);

    if(pos == 1)
    {
        newNode->next = start;
        return newNode;
    }

    for(i = 1; i < pos - 1 && p != NULL; i++)
        p = p->next;

    if(p == NULL)
    {
        printf("There are less than %d elements\n", pos);
        return start;
    }

    newNode->next = p->next;
    p->next = newNode;

    return start;
}

/* Delete node */
node *del(node *start, int data)
{
    node *p = start, *tmp;

    if(start == NULL)
    {
        printf("List is empty\n");
        return start;
    }

    /* delete first */
    if(start->roll_no == data)
    {
        tmp = start;
        start = start->next;
        free(tmp);
        return start;
    }

    /* delete in between */
    while(p->next != NULL)
    {
        if(p->next->roll_no == data)
        {
            tmp = p->next;
            p->next = tmp->next;
            free(tmp);
            return start;
        }
        p = p->next;
    }

    printf("Element %d not found\n", data);
    return start;
}

/* Reverse list */
node *reverse(node *start)
{
    node *prev = NULL, *ptr = start, *next;

    while(ptr != NULL)
    {
        next = ptr->next;
        ptr->next = prev;
        prev = ptr;
        ptr = next;
    }

    return prev;
}
